# ESP32固件

各种ESP32开发板的固件。ESP32固件早期只有一个通用型号，而现在还支持ESP32-C3、ESP32-S2、ESP32-S3芯片和众多的开发板，有的固件还支持大容量psram，更多ESP32型号也在逐步移植到micropython。

ESP32固件提供了bin、elf、map等多种文件格式，部分带usb功能的esp32还提供了uf2格式。这些不同类型的文件有什么不同，我们应该选择使用哪一种固件文件？

uf2是USB闪存格式（USB Flashing Format）的简写，它是微软为PXT（也称为微软MakeCode）开发，特别适合使用MSC（大容量存储类或可移动闪存驱动器）方式更新微控制器，无需任何编程器就可以直接通过USB更新固件（也就是U盘模式更新）。uf2目前在micropython的分支circuitpython上得到广泛应用。使用uf2方式之前，需要先下载一个uf2 bootloader的固件程序到芯片中，以后升级时就可以通过usb直接复制固件文件方式进行升级了。

elf文件格式非常复杂，它是编译时链接器的直接输出，除了编程数据外，通常还会包含大量符号调试信息。map文件由链接器生成，提供了所有符号在内存中的位置，可以查看每个函数或全局变量占用了多少字节。map文件不包含对设备进行编程的数据。

.bin文件是适用于使用esptool.py直接写入到flash闪存的完整固件。一个完整的固件文件包括引导程序（bootloader）、闪存的分区表以及espressif称为的“应用程序二进制文件”，这也就是microython本身，它是作为独立固件（.app-bin文件）提供的。如果需要安装应用程序固件（例如，使用支持空中传送固件更新的OTA固件）就可以使用app-bin固件。简单的说，正常情况下应该使用 bin 格式固件，OTA 时使用 app-bin 格式固件文件。

也就是说除了map文件外，都可以用于下载固件。但是我们使用最多的是bin固件，它也是最通用的方式；app-bin适合于OTA升级；而uf2是最近开始流行的一种方式，它只支持带有usb功能的芯片。我们可以根据需要灵活选择需要的固件形式。